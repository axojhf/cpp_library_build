name: Intel-Media-SDK Build

on:
  push:
    branches:
      - intel-msdk
jobs:
    msvc-build:
        name: libsndfile MinGW64 Build
        runs-on: windows-latest
        steps:
            - uses: ilammy/msvc-dev-cmd@v1
              with:
                arch: amd64
                toolset: 14.3
            - name: Build
              run: |
                cd C:\ ; git clone --depth=1 https://github.com/Intel-Media-SDK/MediaSDK msdk ; cd msdk
                mkdir build ; cd build
                cmake .. -G Ninja -DCMAKE_BUILD_TYPE=Release -DBUILD_SHARED_LIBS=OFF -DCMAKE_INSTALL_PREFIX=C:/msdk_install
                ninja ; ninja install
            - name: Package Directories
              run: |
                7z a msdk_vs143_static.7z C:\msdk_install
            - uses: actions/upload-artifact@v3
              with:
                name: msdk_vs143_static
                path: msdk_vs143_static.7z
